{% extends "base.html" %}
{% block content %}
<div class="card shadow-sm">
  <div class="card-body">
    <h3 class="card-title">Incidents (recent)</h3>
    <div id="list" class="list-group mt-3"></div>
  </div>
</div>

<script>
(async () => {
  const r = await fetch("/api/incidents/recent");
  const j = await r.json();
  const list = document.getElementById("list");
  list.innerHTML = "";
  (j.incidents || []).forEach(i => {
    const div = document.createElement("div");
    div.className = "list-group-item d-flex justify-content-between";
    div.innerHTML = `
      <div>
        <div class="fw-bold">${(i.type || '').replaceAll('_',' ').toUpperCase()}</div>
        <div class="small text-muted">${i.severity} Â· ${i.status}</div>
        <div class="small">${i.description || ""}</div>
      </div>
      <div class="text-muted small">${new Date(i.created_at).toLocaleString()}</div>`;
    list.appendChild(div);
  });
})();
</script>
{% endblock %}
